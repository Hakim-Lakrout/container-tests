schemaVersion: '2.0.0'

fileExistenceTests:
  - name: "App.py is present"
    path: "/app/app.py"
    shouldExist: true
    uid: 1000
    gid: 1000

  - name: "requirements.txt is present"
    path: "/app/requirements.txt"
    shouldExist: true
    uid: 1000
    gid: 1000

  - name: "data.txt is present and readable by its user"
    path: "/app/data.html"
    shouldExist: true
    permissions: '-r------'
    uid: 1000
    gid: 1000
    
fileContentTests:
  - name: 'Mandatory lib in requirement'
    path: '/app/requirements.txt'
    expectedContents: ['flask']

commandTests:
  - name: "Check Flask is installed"
    command: "pip"
    args: ["list"]
    expectedOutput: ["Flask"]
    exitCode: 0

metadataTest:
  envVars:
    - key: TEST
      value: "Qui suis je"
  cmd: ["python3", "app.py"]
  workdir: "/app"
  user: "python"